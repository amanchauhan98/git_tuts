utility function of version three.good one